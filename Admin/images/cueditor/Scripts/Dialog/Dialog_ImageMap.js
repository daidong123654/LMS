var OxOd23b=["contains","parentNode","selection","document","type","None","Text","body","rangeCount","window","Control","anchorOffset","childNodes","anchorNode","isCollapsed","focusNode","length","nodeType","nodeName","INPUT","TEXTAREA","BUTTON","IMG","SELECT","TABLE","position","style","absolute","relative","top","contentWindow","contentDocument","parentWindow","id","frames","frameElement","//TODO:frame contentWindow not found?","iframe","editor","img","onload","src","","src_cetemp","contentEditable","designMode","on","clearAttributes","marginTop","0","marginLeft","color","black","background","white","unselectable","2D-Position","LiveResize","innerHTML","outerHTML","MAP","name","useMap","#","areas","href","target","alt","coords",",","\x3Cimg id=\x27myIMAGE","\x27 border=1 src=\x27Images/space.gif\x27 title=\x27","\x27 style=\x27position:absolute;left:","px;top:","px;width:","px;height:","px;z-index:","\x27\x3E","MapLink.php","dialogWidth:380px;dialogHeight:200px;help:no;scroll:no;status:no;resizable:0;","zoom","width","height","\x27  border=1 src=\x27Images/space.gif\x27 title=\x27","\x27 style=\x27position:absolute;z-index:",";width:20;height:20;left:",";top:","myIMAGE","\x3Carea shape=\x27rect\x27 coords=\x27","\x27","href=\x27","\x27 ","target=\x27","alt=\x27","\x3E","PasteHTML","\x3Cmap name=\x27","\x3C/map\x3E","off","AutoMap","display","img_zoom_in","none","img_zoom_out","img_bestfit","img_actualsize"];function Element_Contains(element,Ox2e2){if(!Browser_IsOpera()){if(element[OxOd23b[0]]){return element.contains(Ox2e2);} ;} ;for(;Ox2e2!=null;Ox2e2=Ox2e2[OxOd23b[1]]){if(element==Ox2e2){return true;} ;} ;return false;} ;function Window_CreateSelectionRange(Ox309){var Ox388;if(Browser_UseIESelection()){var Ox29f=Ox309[OxOd23b[3]][OxOd23b[2]];if(Ox29f[OxOd23b[4]]==OxOd23b[5]||Ox29f[OxOd23b[4]]==OxOd23b[6]){Ox388=Ox29f.createRange();} else {Ox388=document[OxOd23b[7]].createTextRange();Ox388.moveToElement(Ox29f.createRange().item(0));} ;} else {var Ox29f=Ox309.getSelection();if(Ox29f[OxOd23b[8]]==0){Ox388=Ox309[OxOd23b[3]].createRange();} else {Ox388=Ox29f.getRangeAt(0).cloneRange();} ;} ;Ox388[OxOd23b[9]]=Ox309;return Ox388;} ;function Window_GetSelectionNode(Ox309){var Ox2e2=Window_GetSelectionNode_Core(Ox309);if(Ox2e2==Ox309[OxOd23b[3]][OxOd23b[7]]){return null;} ;if(!Element_Contains(Ox309[OxOd23b[3]].body,Ox2e2)){return null;} ;return Ox2e2;} ;function Window_GetSelectionNode_Core(Ox309){var Ox29f;if(Browser_UseIESelection()){Ox29f=Ox309[OxOd23b[3]][OxOd23b[2]];if(Ox29f[OxOd23b[4]]==OxOd23b[5]||Ox29f[OxOd23b[4]]==OxOd23b[6]){return Ox29f.createRange().parentElement();} ;return Ox29f.createRange().item(0);} ;var Ox29f=Ox309.getSelection();if(Window_GetSelectionType(Ox309)==OxOd23b[10]){return Ox29f[OxOd23b[13]][OxOd23b[12]][Ox29f[OxOd23b[11]]];} ;if(Ox29f[OxOd23b[14]]){return Ox29f[OxOd23b[13]];} ;if(Ox29f[OxOd23b[13]]==Ox29f[OxOd23b[15]]){return Ox29f[OxOd23b[13]];} ;var p=Ox29f[OxOd23b[13]];var Oxc=p[OxOd23b[12]];for(var i=0;i<Oxc[OxOd23b[16]];i++){var Ox3a5=Oxc.item(i);if(Ox29f.containsNode(Ox3a5,true)){if(i!=0&&Ox29f.containsNode(Oxc.item(i-1),false)){continue ;} ;if(i<Oxc[OxOd23b[16]]-1&&Ox29f.containsNode(Oxc.item(i+1),false)){continue ;} ;return Ox3a5;} ;} ;if(Ox29f[OxOd23b[8]]==1){return Range_GetParentNode(Window_CreateSelectionRange(Ox309));} ;if(!Element_Contains(Ox309[OxOd23b[3]].body,Ox29f.anchorNode)){return null;} ;return Element_GetSameParent(Ox29f.anchorNode,Ox29f.focusNode);} ;function Window_GetSelectionElement(Ox309){var Ox2e2=Window_GetSelectionNode(Ox309);if(Ox2e2==null){return null;} ;if(Ox2e2[OxOd23b[17]]==1){return Ox2e2;} ;return Ox2e2[OxOd23b[1]];} ;function Window_GetSelectionType(Ox309){if(Browser_UseIESelection()){return Ox309[OxOd23b[3]][OxOd23b[2]][OxOd23b[4]];} ;var Ox29f=Ox309.getSelection();if(Ox29f[OxOd23b[14]]){return OxOd23b[6];} ;if(Ox29f[OxOd23b[13]]!=Ox29f[OxOd23b[15]]){return OxOd23b[6];} ;var p=Ox29f[OxOd23b[13]];var Oxc=p[OxOd23b[12]];for(var i=0;i<Oxc[OxOd23b[16]];i++){var Ox3a5=Oxc.item(i);if(Ox3a5[OxOd23b[17]]!=1){continue ;} ;if(Ox29f.containsNode(Ox3a5,true)){if(i!=0&&Ox29f.containsNode(Oxc.item(i-1),false)){continue ;} ;if(i<Oxc[OxOd23b[16]]-1&&Ox29f.containsNode(Oxc.item(i+1),false)){continue ;} ;if(Element_IsBlockControl(Ox3a5)){return OxOd23b[10];} ;return OxOd23b[6];} ;} ;return OxOd23b[6];} ;function Element_IsBlockControl(element){var name=element[OxOd23b[18]];if(name==OxOd23b[19]){return true;} ;if(name==OxOd23b[20]){return true;} ;if(name==OxOd23b[21]){return true;} ;if(name==OxOd23b[22]){return true;} ;if(name==OxOd23b[23]){return true;} ;if(name==OxOd23b[24]){return true;} ;var Ox26e=element[OxOd23b[26]][OxOd23b[25]];if(Ox26e==OxOd23b[27]||Ox26e==OxOd23b[28]){return true;} ;return false;} ;function Window_GetDialogTop(Ox309){return Ox309[OxOd23b[29]];} ;function Frame_GetContentWindow(Ox4b2){if(Ox4b2[OxOd23b[30]]){return Ox4b2[OxOd23b[30]];} ;if(Ox4b2[OxOd23b[31]]){if(Ox4b2[OxOd23b[31]][OxOd23b[32]]){return Ox4b2[OxOd23b[31]][OxOd23b[32]];} ;} ;var Ox309;if(Ox4b2[OxOd23b[33]]){Ox309=window[OxOd23b[34]][Ox4b2[OxOd23b[33]]];if(Ox309){return Ox309;} ;} ;var len=window[OxOd23b[34]][OxOd23b[16]];for(var i=0;i<len;i++){Ox309=window[OxOd23b[34]][i];if(Ox309[OxOd23b[35]]==Ox4b2){return Ox309;} ;if(Ox309[OxOd23b[3]]==Ox4b2[OxOd23b[31]]){return Ox309;} ;} ;Debug_Todo(OxOd23b[36]);} ;var iframe=Window_GetElement(window,OxOd23b[37],true);var iframe_win=Frame_GetContentWindow(iframe);var obj=Window_GetDialogArguments(window);var editor=obj[OxOd23b[38]];var editwin=obj[OxOd23b[9]];var editdoc=obj[OxOd23b[3]];var oImg=obj[OxOd23b[39]];var oMap=null;var aMapName= new Array();var aLeft= new Array();var aTop= new Array();var aWidth= new Array();var aHeight= new Array();var aHref= new Array();var aTarget= new Array();var aTitle= new Array();var aCoords= new Array();window[OxOd23b[40]]=function window_onload(){var src;src=oImg.getAttribute(OxOd23b[41])+OxOd23b[42];if(oImg.getAttribute(OxOd23b[43])){src=oImg.getAttribute(OxOd23b[43])+OxOd23b[42];} ;oImg[OxOd23b[41]]=src;if(Browser_IsWinIE()){iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[44]]=true;} else {iframe_win[OxOd23b[3]][OxOd23b[45]]=OxOd23b[46];iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[44]]=true;} ;iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[47]];iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[26]][OxOd23b[48]]=OxOd23b[49];iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[26]][OxOd23b[50]]=OxOd23b[49];iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[26]][OxOd23b[51]]=OxOd23b[52];iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[26]][OxOd23b[53]]=OxOd23b[54];oImg[OxOd23b[55]]=OxOd23b[46];if(Browser_IsWinIE()){iframe_win[OxOd23b[3]].execCommand(OxOd23b[56],true,true);iframe_win[OxOd23b[3]].execCommand(OxOd23b[57],true,true);} ;iframe_win.focus();if(Browser_IsWinIE()){iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[58]]=oImg[OxOd23b[59]];} else {iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[58]]=outerHTML(oImg);} ;var Ox4c0=editdoc[OxOd23b[7]].getElementsByTagName(OxOd23b[60]);for(var i=0;i<Ox4c0[OxOd23b[16]];i++){aMapName[i]=Ox4c0[i][OxOd23b[61]].toUpperCase();} ;var Ox4c1=oImg[OxOd23b[62]];if(Ox4c1!=OxOd23b[42]){Ox4c1=Ox4c1.toUpperCase();for(var i=0;i<Ox4c0[OxOd23b[16]];i++){if((OxOd23b[63]+aMapName[i])==Ox4c1){oMap=Ox4c0[i];} ;} ;} ;if(oMap){for(var i=0;i<oMap[OxOd23b[64]][OxOd23b[16]];i++){aHref[i]=oMap[OxOd23b[64]][i][OxOd23b[65]];aTarget[i]=oMap[OxOd23b[64]][i][OxOd23b[66]];aTitle[i]=oMap[OxOd23b[64]][i][OxOd23b[67]];aCoords[i]=oMap[OxOd23b[64]][i][OxOd23b[68]];var Ox1b=aCoords[i].split(OxOd23b[69]);aLeft[i]=parseInt(Ox1b[0]);aTop[i]=parseInt(Ox1b[1]);aWidth[i]=parseInt(Ox1b[2])-aLeft[i];aHeight[i]=parseInt(Ox1b[3])-aTop[i];iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[58]]+=OxOd23b[70]+i+OxOd23b[71]+AddLinktoImageMap+OxOd23b[72]+aLeft[i]+OxOd23b[73]+aTop[i]+OxOd23b[74]+aWidth[i]+OxOd23b[75]+aHeight[i]+OxOd23b[76]+(i+1)+OxOd23b[77];} ;} ;} ;function SearchSelectionElement(Ox4c3){var body=iframe_win[OxOd23b[3]][OxOd23b[7]];for(var Ox2b8=Window_GetSelectionElement(iframe_win);Element_Contains(body,Ox2b8);Ox2b8=Ox2b8[OxOd23b[1]]){if(Ox2b8[OxOd23b[18]]==Ox4c3){return Ox2b8;} ;} ;return null;} ;function Addlink(){var img=SearchSelectionElement(OxOd23b[22]);if(!img){return ;} ;function Ox4c7(arr){if(arr){aHref[Ox4c9]=arr[0];aTarget[Ox4c9]=arr[1];aTitle[Ox4c9]=arr[2];} ;} ;var Ox4c8=img[OxOd23b[33]];var Ox4c9=parseInt(Ox4c8.substr(7));var obj={editor:editor,href:aHref[Ox4c9],target:aTarget[Ox4c9],title:aTitle[Ox4c9]};editor.SetNextDialogWindow(window);editor.ShowDialog(Ox4c7,OxOd23b[78]+query_string,obj,OxOd23b[79]);} ;function do_Close(){Window_SetDialogReturnValue(window,null);Window_CloseDialog(window);} ;function Zoom_In(){if(iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[26]][OxOd23b[80]]!=0){iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[26]][OxOd23b[80]]*=1.2;} else {iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[26]][OxOd23b[80]]=1.2;} ;} ;function Zoom_Out(){if(iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[26]][OxOd23b[80]]!=0){iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[26]][OxOd23b[80]]*=0.8;} else {iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[26]][OxOd23b[80]]=0.8;} ;} ;function BestFit(){if(!oImg){return ;} ;var Ox4cd=280;var Ox2b2=290;iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[26]][OxOd23b[80]]=1/Math.max(oImg[OxOd23b[81]]/Ox2b2,oImg[OxOd23b[82]]/Ox4cd);} ;function Actualsize(){iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[26]][OxOd23b[80]]=1;} ;function newMap(){var Ox27d=aHref[OxOd23b[16]];var Ox4d0=(oImg[OxOd23b[81]]-20)*0.5;var Ox4a4=(oImg[OxOd23b[82]]-20)*0.5;aHref[Ox27d]=OxOd23b[42];aTarget[Ox27d]=OxOd23b[42];aTitle[Ox27d]=OxOd23b[42];iframe_win[OxOd23b[3]][OxOd23b[7]][OxOd23b[58]]+=OxOd23b[70]+Ox27d+OxOd23b[83]+AddLinktoImageMap+OxOd23b[84]+(Ox27d+1)+OxOd23b[85]+Ox4d0+OxOd23b[86]+Ox4a4+OxOd23b[77];iframe_win.scrollBy(0,0);iframe_win.focus();} ;function do_insert(){var Ox1c=false;for(var i=0;i<aHref[OxOd23b[16]];i++){var obj=Window_GetElement(iframe_win,OxOd23b[87]+i,false);if(obj){Ox1c=true;} ;} ;if(Ox1c){var Ox3e6=OxOd23b[42];for(var i=0;i<aHref[OxOd23b[16]];i++){var obj=Window_GetElement(iframe_win,OxOd23b[87]+i,false);if(obj){var Ox4d1=parseInt(obj[OxOd23b[26]].left);var Ox4d2=parseInt(obj[OxOd23b[26]].top);var Ox4d3=parseInt(obj[OxOd23b[26]].width);var Ox4d4=parseInt(obj[OxOd23b[26]].height);var Ox4d5=Ox4d1+Ox4d3;var Ox4d6=Ox4d2+Ox4d4;Ox3e6+=OxOd23b[88]+Ox4d1+OxOd23b[69]+Ox4d2+OxOd23b[69]+Ox4d5+OxOd23b[69]+Ox4d6+OxOd23b[89];if(aHref[i]!=OxOd23b[42]){Ox3e6+=OxOd23b[90]+aHref[i]+OxOd23b[91];} ;if((aTarget[i]!=OxOd23b[42])&&aTarget[i]){Ox3e6+=OxOd23b[92]+aTarget[i]+OxOd23b[91];} ;if(aTitle[i]!=OxOd23b[42]&&aTitle[i]!=null){Ox3e6+=OxOd23b[93]+aTitle[i]+OxOd23b[91];} ;Ox3e6+=OxOd23b[94];} ;} ;if(oMap){oMap[OxOd23b[58]]=Ox3e6;} else {var Ox4c1=getAutoMapName();oImg[OxOd23b[62]]=OxOd23b[63]+Ox4c1;editor.ExecCommand(OxOd23b[95],false,OxOd23b[96]+Ox4c1+OxOd23b[77]+Ox3e6+OxOd23b[97]);} ;} else {if(oMap){if(Browser_IsWinIE()){oMap[OxOd23b[59]]=OxOd23b[42];} ;} ;oImg[OxOd23b[62]]=OxOd23b[42];} ;oImg[OxOd23b[55]]=OxOd23b[98];oImg.removeAttribute(OxOd23b[55]);if(!Browser_IsWinIE()){editor.InsertElement(oImg);} ;Window_CloseDialog(window);} ;function getAutoMapName(){for(var i=1;true;i++){var Ox234=OxOd23b[99]+i;if(isValidMapName(Ox234)){return Ox234;} ;} ;} ;function isValidMapName(Oxb){Oxb=Oxb.toUpperCase();for(var i=0;i<aMapName[OxOd23b[16]];i++){if(aMapName[i]==Oxb){return false;} ;} ;return true;} ;function do_Close(){oImg.removeAttribute(OxOd23b[55]);Window_CloseDialog(window);} ;if(!Browser_IsWinIE()){Window_GetElement(window,OxOd23b[101],true)[OxOd23b[26]][OxOd23b[100]]=OxOd23b[102];Window_GetElement(window,OxOd23b[103],true)[OxOd23b[26]][OxOd23b[100]]=OxOd23b[102];Window_GetElement(window,OxOd23b[104],true)[OxOd23b[26]][OxOd23b[100]]=OxOd23b[102];Window_GetElement(window,OxOd23b[105],true)[OxOd23b[26]][OxOd23b[100]]=OxOd23b[102];} ;